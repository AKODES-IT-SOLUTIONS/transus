/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Directive, Input, Output, EventEmitter, HostListener } from '@angular/core';
import { Angular4PaystackService } from './angular4-paystack.service';
/**
 * @record
 */
import * as ɵngcc0 from '@angular/core';
function MyWindow() { }
if (false) {
    /** @type {?} */
    MyWindow.prototype.PaystackPop;
}
var Angular4PaystackDirective = /** @class */ (function () {
    function Angular4PaystackDirective(paystackService) {
        this.paystackService = paystackService;
        this.paymentInit = new EventEmitter(); // tslint:disable-line
        // tslint:disable-line
        this.onClose = new EventEmitter(); // tslint:disable-line
        // tslint:disable-line
        this.callback = new EventEmitter();
        // tslint:disable-line
        this.isPaying = false;
    }
    /**
     * @return {?}
     */
    Angular4PaystackDirective.prototype.pay = /**
     * @return {?}
     */
    function () {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var errorText, payment;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        errorText = '';
                        if (this.paystackOptions && Object.keys(this.paystackOptions).length >= 2) {
                            errorText = this.valdateInput(this.paystackOptions);
                            this.generateOptions(this.paystackOptions);
                        }
                        else {
                            errorText = this.valdateInput(this);
                            this.generateOptions(this);
                        }
                        if (errorText) {
                            console.error(errorText);
                            return [2 /*return*/, errorText];
                        }
                        return [4 /*yield*/, this.paystackService.loadScript()];
                    case 1:
                        _a.sent();
                        if (this.isPaying) {
                            return [2 /*return*/];
                        }
                        if (this.paymentInit.observers.length) {
                            this.paymentInit.emit();
                        }
                        payment = window.PaystackPop.setup(this._paystackOptions);
                        payment.openIframe();
                        this.isPaying = true;
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    Angular4PaystackDirective.prototype.valdateInput = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        if (!this.callback.observers.length) {
            return 'ANGULAR-PAYSTACK: Insert a callback output like so (callback)=\'PaymentComplete($event)\' to check payment status';
        }
        return this.paystackService.checkInput(obj);
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    Angular4PaystackDirective.prototype.generateOptions = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        var _this = this;
        this._paystackOptions = this.paystackService.getPaystackOptions(obj);
        this._paystackOptions.onClose = (/**
         * @return {?}
         */
        function () {
            if (_this.onClose.observers.length) {
                _this.isPaying = false;
                _this.onClose.emit();
            }
        });
        this._paystackOptions.callback = (/**
         * @param {...?} response
         * @return {?}
         */
        function () {
            var _a;
            var response = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                response[_i] = arguments[_i];
            }
            _this.isPaying = false;
            (_a = _this.callback).emit.apply(_a, tslib_1.__spread(response));
        });
    };
    /**
     * @return {?}
     */
    Angular4PaystackDirective.prototype.buttonClick = /**
     * @return {?}
     */
    function () {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            return tslib_1.__generator(this, function (_a) {
                this.pay();
                return [2 /*return*/];
            });
        });
    };
    /** @nocollapse */
    Angular4PaystackDirective.ctorParameters = function () { return [
        { type: Angular4PaystackService }
    ]; };
    Angular4PaystackDirective.propDecorators = {
        key: [{ type: Input }],
        email: [{ type: Input }],
        amount: [{ type: Input }],
        metadata: [{ type: Input }],
        ref: [{ type: Input }],
        currency: [{ type: Input }],
        plan: [{ type: Input }],
        quantity: [{ type: Input }],
        subaccount: [{ type: Input }],
        channels: [{ type: Input }],
        transaction_charge: [{ type: Input }],
        bearer: [{ type: Input }],
        class: [{ type: Input }],
        style: [{ type: Input }],
        paystackOptions: [{ type: Input }],
        paymentInit: [{ type: Output }],
        onClose: [{ type: Output }],
        callback: [{ type: Output }],
        buttonClick: [{ type: HostListener, args: ['click',] }]
    };
Angular4PaystackDirective.ɵfac = function Angular4PaystackDirective_Factory(t) { return new (t || Angular4PaystackDirective)(ɵngcc0.ɵɵdirectiveInject(Angular4PaystackService)); };
Angular4PaystackDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: Angular4PaystackDirective, selectors: [["", "angular4-paystack", ""]], hostBindings: function Angular4PaystackDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function Angular4PaystackDirective_click_HostBindingHandler() { return ctx.buttonClick(); });
    } }, inputs: { key: "key", email: "email", amount: "amount", metadata: "metadata", ref: "ref", currency: "currency", plan: "plan", quantity: "quantity", subaccount: "subaccount", channels: "channels", transaction_charge: "transaction_charge", bearer: "bearer", class: "class", style: "style", paystackOptions: "paystackOptions" }, outputs: { paymentInit: "paymentInit", onClose: "onClose", callback: "callback" } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(Angular4PaystackDirective, [{
        type: Directive,
        args: [{
                selector: '[angular4-paystack]'
            }]
    }], function () { return [{ type: Angular4PaystackService }]; }, { paymentInit: [{
            type: Output
        }], onClose: [{
            type: Output
        }], callback: [{
            type: Output
        }], buttonClick: [{
            type: HostListener,
            args: ['click']
        }], key: [{
            type: Input
        }], email: [{
            type: Input
        }], amount: [{
            type: Input
        }], metadata: [{
            type: Input
        }], ref: [{
            type: Input
        }], currency: [{
            type: Input
        }], plan: [{
            type: Input
        }], quantity: [{
            type: Input
        }], subaccount: [{
            type: Input
        }], channels: [{
            type: Input
        }], transaction_charge: [{
            type: Input
        }], bearer: [{
            type: Input
        }], class: [{
            type: Input
        }], style: [{
            type: Input
        }], paystackOptions: [{
            type: Input
        }] }); })();
    return Angular4PaystackDirective;
}());
export { Angular4PaystackDirective };
if (false) {
    /** @type {?} */
    Angular4PaystackDirective.prototype.key;
    /** @type {?} */
    Angular4PaystackDirective.prototype.email;
    /** @type {?} */
    Angular4PaystackDirective.prototype.amount;
    /** @type {?} */
    Angular4PaystackDirective.prototype.metadata;
    /** @type {?} */
    Angular4PaystackDirective.prototype.ref;
    /** @type {?} */
    Angular4PaystackDirective.prototype.currency;
    /** @type {?} */
    Angular4PaystackDirective.prototype.plan;
    /** @type {?} */
    Angular4PaystackDirective.prototype.quantity;
    /** @type {?} */
    Angular4PaystackDirective.prototype.subaccount;
    /** @type {?} */
    Angular4PaystackDirective.prototype.channels;
    /** @type {?} */
    Angular4PaystackDirective.prototype.transaction_charge;
    /** @type {?} */
    Angular4PaystackDirective.prototype.bearer;
    /** @type {?} */
    Angular4PaystackDirective.prototype.class;
    /** @type {?} */
    Angular4PaystackDirective.prototype.style;
    /** @type {?} */
    Angular4PaystackDirective.prototype.paystackOptions;
    /** @type {?} */
    Angular4PaystackDirective.prototype.paymentInit;
    /** @type {?} */
    Angular4PaystackDirective.prototype.onClose;
    /** @type {?} */
    Angular4PaystackDirective.prototype.callback;
    /**
     * @type {?}
     * @private
     */
    Angular4PaystackDirective.prototype._paystackOptions;
    /**
     * @type {?}
     * @private
     */
    Angular4PaystackDirective.prototype.isPaying;
    /**
     * @type {?}
     * @private
     */
    Angular4PaystackDirective.prototype.paystackService;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhcjQtcGF5c3RhY2suZGlyZWN0aXZlLmpzIiwic291cmNlcyI6WyJuZzovYW5ndWxhcjQtcGF5c3RhY2svbGliL2FuZ3VsYXI0LXBheXN0YWNrLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXJGLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3RFO0FBQ0c7QUFBVzs7QUFBZCx1QkFJQztBQUNEO0FBQWE7QUFFVixJQU5ELCtCQUVFO0FBQ0o7QUFHQTtBQUNnRCxJQXdCOUMsbUNBQW9CLGVBQXdDO0FBQUksUUFBNUMsb0JBQWUsR0FBZixlQUFlLENBQXlCO0FBQUMsUUFObkQsZ0JBQVcsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQyxDQUFDLHNCQUFzQjtBQUM1RjtBQUErQixRQUFuQixZQUFPLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUMsQ0FBQyxzQkFBc0I7QUFDeEY7QUFBK0IsUUFBbkIsYUFBUSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO0FBQ2xFO0FBQStCLFFBQ3JCLGFBQVEsR0FBRyxLQUFLLENBQUM7QUFDM0IsSUFDaUUsQ0FBQztBQUNsRTtBQUNPO0FBQ0c7QUFBUSxJQURWLHVDQUFHO0FBQ1Q7QUFBbUI7QUFDaEIsSUFGSDtBQUNGO0FBQzZDO0FBQzdDO0FBQ0U7QUFBb0M7QUFFbkMsd0JBTEssU0FBUyxHQUFHLEVBQUU7QUFDdEIsd0JBQUksSUFBSSxJQUFJLENBQUMsZUFBZSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7QUFDL0UsNEJBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FB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LEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQVlBLEFBWEEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBR0EsQUFBQSxBQURBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUExRUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQVhBLEFBQUEsQUFhQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFrREEsQUFBQSxBQUFBLEFBQUEsQUFJQSxBQUFBLEFBQUEsQUEzRUEsQUEyRUEsQUF4RUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBIb3N0TGlzdGVuZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUGF5c3RhY2tPcHRpb25zLCBQcml2YXRlUGF5c3RhY2tPcHRpb25zIH0gZnJvbSAnLi9wYXlzdGFjay1vcHRpb25zJztcclxuaW1wb3J0IHsgQW5ndWxhcjRQYXlzdGFja1NlcnZpY2UgfSBmcm9tICcuL2FuZ3VsYXI0LXBheXN0YWNrLnNlcnZpY2UnO1xyXG5cclxuaW50ZXJmYWNlIE15V2luZG93IGV4dGVuZHMgV2luZG93IHtcclxuICBQYXlzdGFja1BvcDoge1xyXG4gICAgc2V0dXAob3B0aW9uczogUGFydGlhbDxQYXlzdGFja09wdGlvbnM+KTogeyBvcGVuSWZyYW1lKCk6IGFueSB9XHJcbiAgfTtcclxufVxyXG5kZWNsYXJlIHZhciB3aW5kb3c6IE15V2luZG93O1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgc2VsZWN0b3I6ICdbYW5ndWxhcjQtcGF5c3RhY2tdJywgLy8gdHNsaW50OmRpc2FibGUtbGluZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQW5ndWxhcjRQYXlzdGFja0RpcmVjdGl2ZSB7XHJcbiAgQElucHV0KCkga2V5OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgZW1haWw6IHN0cmluZztcclxuICBASW5wdXQoKSBhbW91bnQ6IG51bWJlcjtcclxuICBASW5wdXQoKSBtZXRhZGF0YToge307XHJcbiAgQElucHV0KCkgcmVmOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY3VycmVuY3k6IHN0cmluZztcclxuICBASW5wdXQoKSBwbGFuOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgcXVhbnRpdHk6IHN0cmluZztcclxuICBASW5wdXQoKSBzdWJhY2NvdW50OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2hhbm5lbHM6IHN0cmluZ1tdO1xyXG4gIEBJbnB1dCgpIHRyYW5zYWN0aW9uX2NoYXJnZTogbnVtYmVyOyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lXHJcbiAgQElucHV0KCkgYmVhcmVyOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2xhc3M6IHN0cmluZztcclxuICBASW5wdXQoKSBzdHlsZTogb2JqZWN0O1xyXG4gIEBJbnB1dCgpIHBheXN0YWNrT3B0aW9uczogUGF5c3RhY2tPcHRpb25zO1xyXG4gIEBPdXRwdXQoKSBwYXltZW50SW5pdDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTsgLy8gdHNsaW50OmRpc2FibGUtbGluZVxyXG4gIEBPdXRwdXQoKSBvbkNsb3NlOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpOyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lXHJcbiAgQE91dHB1dCgpIGNhbGxiYWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIHByaXZhdGUgX3BheXN0YWNrT3B0aW9uczogUGFydGlhbDxQcml2YXRlUGF5c3RhY2tPcHRpb25zPjsgLy8gdHNsaW50OmRpc2FibGUtbGluZVxyXG4gIHByaXZhdGUgaXNQYXlpbmcgPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBwYXlzdGFja1NlcnZpY2U6IEFuZ3VsYXI0UGF5c3RhY2tTZXJ2aWNlKSB7fVxyXG5cclxuICBhc3luYyBwYXkoKSB7XHJcbiAgICBsZXQgZXJyb3JUZXh0ID0gJyc7XHJcbiAgICBpZiAodGhpcy5wYXlzdGFja09wdGlvbnMgJiYgT2JqZWN0LmtleXModGhpcy5wYXlzdGFja09wdGlvbnMpLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgIGVycm9yVGV4dCA9IHRoaXMudmFsZGF0ZUlucHV0KHRoaXMucGF5c3RhY2tPcHRpb25zKTtcclxuICAgICAgdGhpcy5nZW5lcmF0ZU9wdGlvbnModGhpcy5wYXlzdGFja09wdGlvbnMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZXJyb3JUZXh0ID0gdGhpcy52YWxkYXRlSW5wdXQodGhpcyk7XHJcbiAgICAgIHRoaXMuZ2VuZXJhdGVPcHRpb25zKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKGVycm9yVGV4dCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yVGV4dCk7XHJcbiAgICAgIHJldHVybiBlcnJvclRleHQ7XHJcbiAgICB9XHJcbiAgICBhd2FpdCB0aGlzLnBheXN0YWNrU2VydmljZS5sb2FkU2NyaXB0KCk7XHJcbiAgICBpZiAodGhpcy5pc1BheWluZykgeyByZXR1cm47IH1cclxuICAgIGlmICh0aGlzLnBheW1lbnRJbml0Lm9ic2VydmVycy5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5wYXltZW50SW5pdC5lbWl0KCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBwYXltZW50ID0gd2luZG93LlBheXN0YWNrUG9wLnNldHVwKHRoaXMuX3BheXN0YWNrT3B0aW9ucyk7XHJcbiAgICBwYXltZW50Lm9wZW5JZnJhbWUoKTtcclxuICAgIHRoaXMuaXNQYXlpbmcgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgdmFsZGF0ZUlucHV0KG9iajogUGF5c3RhY2tPcHRpb25zKSB7XHJcbiAgICBpZiAoIXRoaXMuY2FsbGJhY2sub2JzZXJ2ZXJzLmxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gJ0FOR1VMQVItUEFZU1RBQ0s6IEluc2VydCBhIGNhbGxiYWNrIG91dHB1dCBsaWtlIHNvIChjYWxsYmFjayk9XFwnUGF5bWVudENvbXBsZXRlKCRldmVudClcXCcgdG8gY2hlY2sgcGF5bWVudCBzdGF0dXMnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMucGF5c3RhY2tTZXJ2aWNlLmNoZWNrSW5wdXQob2JqKTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlT3B0aW9ucyhvYmo6IFBheXN0YWNrT3B0aW9ucykge1xyXG4gICAgdGhpcy5fcGF5c3RhY2tPcHRpb25zID0gdGhpcy5wYXlzdGFja1NlcnZpY2UuZ2V0UGF5c3RhY2tPcHRpb25zKG9iaik7XHJcbiAgICB0aGlzLl9wYXlzdGFja09wdGlvbnMub25DbG9zZSA9ICgpID0+IHtcclxuICAgICAgaWYgKHRoaXMub25DbG9zZS5vYnNlcnZlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5pc1BheWluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub25DbG9zZS5lbWl0KCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLl9wYXlzdGFja09wdGlvbnMuY2FsbGJhY2sgPSAoLi4ucmVzcG9uc2UpID0+IHtcclxuICAgICAgdGhpcy5pc1BheWluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmNhbGxiYWNrLmVtaXQoLi4ucmVzcG9uc2UpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJylcclxuICBhc3luYyBidXR0b25DbGljaygpIHtcclxuICAgIHRoaXMucGF5KCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==